datasource db {
  provider          = "postgresql"
  url               = env("DATABASE_URL")
  shadowDatabaseUrl = env("SHADOW_DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
  output = "../node_modules/.prisma/client"
}

model Usuario {
  id         Int      @id @default(autoincrement())
  email      String   @unique
  username   String   @unique
  nome       String
  senha      String
  created_at DateTime @default(now())
  updated_at DateTime @updatedAt
  id_tipo_login Int

  tipo_login TipoLogin @relation(fields: [id_tipo_login], references: [id])
}

model TipoLogin {
  id        Int      @id @default(autoincrement())
  nome      String   @unique
  descricao String

  Usuario Usuario[]
}

model PermissaoUsuario {
  id            Int      @id @default(autoincrement())
  id_usuario    Int
  id_permissao  Int

  permissao   Permissao   @relation(fields: [id_permissao], references: [id])
}

model RegraPermissao {
  id            Int @id @default(autoincrement())
  id_permissao  Int
  id_regra      Int

  permissao Permissao @relation(fields: [id_permissao], references: [id])
  regra     Regra     @relation(fields: [id_regra], references: [id])
}

model Permissao {
  id                Int      @id @default(autoincrement())
  name              String   @unique
  PermissaoUsuario  PermissaoUsuario[]
  RegraPermissao    RegraPermissao[]
}

model Regra {
  id             Int      @id @default(autoincrement())
  name           String   @unique
  RegraPermissao RegraPermissao[]
}

model Curso {
  id             Int      @id @default(autoincrement())
  abreviacao     String   @unique
  nome           String
  descricao      String

  blocos         Bloco[]
}

model Bloco {
  id             Int      @id @default(autoincrement())
  numero_bloco   Int
  id_curso       Int

  curso          Curso    @relation(fields: [id_curso], references: [id], onDelete: Cascade)
  materias       Materia[]
}

model Materia {
  id             Int      @id @default(autoincrement())
  id_bloco       Int
  abreviacao     String
  nome           String
  descricao      String

  bloco          Bloco    @relation(fields: [id_bloco], references: [id], onDelete: Cascade)
  questoes       Questao[]
}

model Questao {
  id                      Int      @id @default(autoincrement())
  id_materia              Int
  questao_texto           String
  questao_a               String
  questao_b               String
  questao_c               String
  questao_d               String
  alternativa_correta     String

  materia                 Materia  @relation(fields: [id_materia], references: [id], onDelete: Cascade)
}
